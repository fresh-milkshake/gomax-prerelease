<p align="center">
    <img src="gomax/assets/logo.svg" alt="GoMax" width="400">
</p>

<p align="center">
    <strong>Go –∫–ª–∏–µ–Ω—Ç –¥–ª—è API –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ Max</strong>
</p>

<p align="center">
    <img src="https://img.shields.io/badge/go-1.22+-00ADD8.svg" alt="Go 1.22+">
    <img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License: MIT">
    <a href="https://deepwiki.com/fresh-milkshake/gomax-prerelease">
        <img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki">
    </a>
</p>

> [!WARNING]
> * –≠—Ç–æ **–Ω–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è** –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º API Max.
> * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç **–Ω–∞—Ä—É—à–∞—Ç—å —É—Å–ª–æ–≤–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —É—Å–ª—É–≥** —Å–µ—Ä–≤–∏—Å–∞.
> * **–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –µ—ë –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫.**
> * **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –∫–æ–Ω—Ç—Ä–∏–±—å—é—Ç–æ—Ä—ã –Ω–µ –Ω–µ—Å—É—Ç –Ω–∏–∫–∞–∫–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** –∑–∞ –ª—é–±—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –ø–∞–∫–µ—Ç–∞, –≤–∫–ª—é—á–∞—è, –Ω–æ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—è—Å—å: –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –∞–∫–∫–∞—É–Ω—Ç–æ–≤, —É—Ç–µ—Ä—é –¥–∞–Ω–Ω—ã—Ö, —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –∏ –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–±–ª–µ–º—ã.
> * API –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω—ë–Ω –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.

## –û–ø–∏—Å–∞–Ω–∏–µ

**GoMax** ‚Äî Go –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ Max. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Ç–∞–º–∏, –∫–∞–Ω–∞–ª–∞–º–∏ –∏ –¥–∏–∞–ª–æ–≥–∞–º–∏ —á–µ—Ä–µ–∑ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–ª–æ–≥–∏–Ω –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
- –û—Ç–ø—Ä–∞–≤–∫–∞, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ, —Ñ–∞–π–ª–æ–≤ –∏ –≤–∏–¥–µ–æ
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏ –∏ –∫–∞–Ω–∞–ª–∞–º–∏
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- –†–∞–±–æ—Ç–∞ —Å —Ä–µ–∞–∫—Ü–∏—è–º–∏
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–ø–∫–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

> [!IMPORTANT]
> –î–ª—è —Ä–∞–±–æ—Ç—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è Go 1.22 –∏–ª–∏ –≤—ã—à–µ

```bash
go get github.com/fresh-milkshake/gomax
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä

```go
package main

import (
    "context"
    "time"

    "github.com/charmbracelet/log"
    "github.com/fresh-milkshake/gomax"
    "github.com/fresh-milkshake/gomax/types"
)

func main() {
    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
    client, err := gomax.NewMaxClient(gomax.ClientConfig{
        Phone:   "+79991234567",
        WorkDir: "cache", // –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏
    })
    if err != nil {
        log.Fatal("Failed to create client", "err", err)
    }
    defer client.Close()

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    client.OnMessage(func(ctx context.Context, msg *types.Message) {
        log.Info("New message", "text", msg.Text)
    }, nil)

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    client.OnStart(func(ctx context.Context) {
        log.Info("Client started!")
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        _, err := client.SendMessage(ctx, "–ü—Ä–∏–≤–µ—Ç!", 12345, true, nil, nil, nil)
        if err != nil {
            log.Error("Failed to send message", "err", err)
        }
    })

    // –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞
    ctx, cancel := context.WithTimeout(context.Background(), 5*time.Minute)
    defer cancel()

    if err := client.Start(ctx); err != nil {
        log.Fatal("Failed to start", "err", err)
    }

    // –î–µ—Ä–∂–∏–º –∫–ª–∏–µ–Ω—Ç –∞–∫—Ç–∏–≤–Ω—ã–º
    select {}
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CodeProvider –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

```go
client, err := gomax.NewMaxClient(gomax.ClientConfig{
    Phone:   "+79991234567",
    WorkDir: "cache",
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ Telegram –±–æ—Ç–∞)
    CodeProvider: func(ctx context.Context) (string, error) {
        // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–¥–∞
        return "123456", nil
    },
})
```

### –ö–∞—Å—Ç–æ–º–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ª–æ–≥–∏—Ä—É–µ—Ç –≤ stderr —Å —É—Ä–æ–≤–Ω–µ–º Info. –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–≤–æ–π –ª–æ–≥–≥–µ—Ä:

```go
import (
    "io"
    "os"
    
    "github.com/charmbracelet/log"
    "github.com/fresh-milkshake/gomax"
)

// –õ–æ–≥–≥–µ—Ä —Å —É—Ä–æ–≤–Ω–µ–º Debug
debugLogger := log.NewWithOptions(os.Stderr, log.Options{
    Level:           log.DebugLevel,
    ReportTimestamp: true,
})

// –õ–æ–≥–≥–µ—Ä —Å –∑–∞–ø–∏—Å—å—é –≤ —Ñ–∞–π–ª
file, _ := os.OpenFile("app.log", os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0644)
fileLogger := log.NewWithOptions(file, log.Options{
    Level:           log.InfoLevel,
    ReportTimestamp: true,
})

// –õ–æ–≥–≥–µ—Ä –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç (—Ç–µ—Ä–º–∏–Ω–∞–ª + —Ñ–∞–π–ª)
multiWriter := io.MultiWriter(os.Stderr, file)
multiLogger := log.NewWithOptions(multiWriter, log.Options{
    Level:           log.DebugLevel,
    ReportTimestamp: true,
})

client, _ := gomax.NewMaxClient(gomax.ClientConfig{
    Phone:   "+79991234567",
    Logger:  multiLogger, // –ü–µ—Ä–µ–¥–∞—ë–º —Å–≤–æ–π –ª–æ–≥–≥–µ—Ä
})
```

## API Reference

### –°–æ–æ–±—â–µ–Ω–∏—è

```go
// –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
msg, err := client.SendMessage(ctx, "–¢–µ–∫—Å—Ç", chatID, notify, photos, files, replyTo)

// –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
msg, err := client.EditMessage(ctx, chatID, messageID, "–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç", photos, files)

// –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
err := client.DeleteMessage(ctx, chatID, []int64{messageID1, messageID2}, forMe)

// –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
messages, err := client.FetchHistory(ctx, chatID, fromMessageID, forward, backward)
```

### –†–µ–∞–∫—Ü–∏–∏

```go
// –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é
info, err := client.AddReaction(ctx, chatID, messageID, "üëç")

// –£–¥–∞–ª–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é
info, err := client.RemoveReaction(ctx, chatID, messageID)

// –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–∫—Ü–∏–∏
reactions, err := client.GetReactions(ctx, chatID, []string{messageID1, messageID2})
```

### –ì—Ä—É–ø–ø—ã –∏ –∫–∞–Ω–∞–ª—ã

```go
// –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É
chat, msg, err := client.CreateGroup(ctx, "–ù–∞–∑–≤–∞–Ω–∏–µ", []int64{userID1, userID2}, notify)

// –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
err := client.InviteUsersToGroup(ctx, chatID, []int64{userID}, showHistory)

// –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
err := client.RemoveUsersFromGroup(ctx, chatID, []int64{userID}, cleanMsgPeriod)

// –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä—É–ø–ø—ã
err := client.ChangeGroupSettings(ctx, chatID, allCanPinMessage, slowMode, onlyAdminCanAddMember, ...)

// –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –≥—Ä—É–ø–ø—ã
err := client.ChangeGroupProfile(ctx, chatID, name, description)

// –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –ø–æ —Å—Å—ã–ª–∫–µ
chat, err := client.JoinGroup(ctx, "https://max.ru/join/...")

// –ó–∞–≥—Ä—É–∑–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
members, nextMarker, err := client.LoadMembers(ctx, chatID, marker, count)
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

```go
// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
user, err := client.GetUser(ctx, userID)

// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
users, err := client.GetUsers(ctx, []int64{userID1, userID2})

// –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
user, err := client.SearchByPhone(ctx, "+79991234567")

// –î–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç
contact, err := client.AddContact(ctx, userID)
err := client.RemoveContact(ctx, userID)
```

### –ü–∞–ø–∫–∏

```go
// –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É
folder, err := client.CreateFolder(ctx, "–†–∞–±–æ—Ç–∞", []int64{chatID1, chatID2}, excludeIDs)

// –ü–æ–ª—É—á–∏—Ç—å –ø–∞–ø–∫–∏
folders, err := client.GetFolders(ctx, folderSync)

// –û–±–Ω–æ–≤–∏—Ç—å –ø–∞–ø–∫—É
folder, err := client.UpdateFolder(ctx, folderID, "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ", includeIDs, excludeIDs, removeIDs)

// –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É
result, err := client.DeleteFolder(ctx, folderID)
```

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π

```go
// –ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
client.OnMessage(func(ctx context.Context, msg *types.Message) {
    log.Info("Message", "text", msg.Text)
}, filter) // filter –º–æ–∂–µ—Ç –±—ã—Ç—å nil

// –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
client.OnMessageEdit(func(ctx context.Context, msg *types.Message) {
    log.Info("Edited", "text", msg.Text)
}, nil)

// –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
client.OnMessageDelete(func(ctx context.Context, msg *types.Message) {
    log.Info("Deleted", "id", msg.ID)
}, nil)

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
client.OnChatUpdate(func(ctx context.Context, chat *types.Chat) {
    log.Info("Chat updated", "id", chat.ID)
})

// –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∞–∫—Ü–∏–π
client.OnReactionChange(func(ctx context.Context, messageID string, chatID int64, info *types.ReactionInfo) {
    log.Info("Reaction changed", "messageID", messageID)
})

// –£—Å–ø–µ—à–Ω—ã–π —Å—Ç–∞—Ä—Ç
client.OnStart(func(ctx context.Context) {
    log.Info("Started!")
})
```

### –§–∏–ª—å—Ç—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π

```go
import "github.com/fresh-milkshake/gomax/filters"

// –§–∏–ª—å—Ç—Ä –ø–æ chatID
filter := &filters.Filter{ChatID: &chatID}

// –§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–∫—Å—Ç—É
text := "–ø—Ä–∏–≤–µ—Ç"
filter := &filters.Filter{TextContains: &text}

// –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
filter := &filters.Filter{
    ChatID:       &chatID,
    TextContains: &text,
}

client.OnMessage(handler, filter)
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
gomax/
‚îú‚îÄ‚îÄ client.go           # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç MaxClient
‚îú‚îÄ‚îÄ client_methods.go   # –ú–µ—Ç–æ–¥—ã API (—Å–æ–æ–±—â–µ–Ω–∏—è, –≥—Ä—É–ø–ø—ã, –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ errors.go           # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ constants/          # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã (URL, —Ç–∞–π–º–∞—É—Ç—ã –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ database/           # –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ (SQLite)
‚îú‚îÄ‚îÄ enums/              # –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è (opcodes, —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ files/              # –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
‚îú‚îÄ‚îÄ filters/            # –§–∏–ª—å—Ç—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ logger/             # –•–µ–ª–ø–µ—Ä—ã –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ payloads/           # –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
‚îú‚îÄ‚îÄ types/              # –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (Message, Chat, User –∏ —Ç.–¥.)
‚îî‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã (JSON, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
```

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

- **[PyMax](https://github.com/ink-developer/PyMax)** ‚Äî Python –≤–µ—Ä—Å–∏—è —ç—Ç–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License. –°–º. —Ñ–∞–π–ª [LICENSE](LICENSE).
